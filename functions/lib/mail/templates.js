"use strict";
// Plantillas de correo HTML y texto para diferentes tipos de notificaciones
// Incluye generaci√≥n de archivos .ics para citas con zona horaria America/Santiago
Object.defineProperty(exports, "__esModule", { value: true });
exports.getWhatsAppTemplate = exports.getQuestionnaireCompletedTemplate = exports.getExamReminderTemplate = exports.getFollowUpTemplate = exports.getExamDocumentTemplate = exports.getAppointmentUpdateTemplate = exports.getAppointmentCancellationTemplate = exports.getDewormingReminderTemplate = exports.getVaccineReminderTemplate = exports.getAppointmentReminderTemplate = exports.getAppointmentConfirmationTemplate = exports.getContactFormTemplate = void 0;
const ics_1 = require("ics");
// Configuraci√≥n de firma para todos los emails
const SIGNATURE = {
    name: "Alejandra Cautin Bastias",
    title: "M√©dico Veterinario",
    phone: "+569 76040797",
    whatsapp: "https://wa.me/56976040797",
    instagram: "@aleveterinaria"
};
// CSS inline para emails responsive
const EMAIL_STYLES = `
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 20px; background-color: #f7f9fc; }
    .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
    .header h1 { margin: 0; font-size: 24px; font-weight: 600; }
    .content { padding: 30px; }
    .highlight { background-color: #f0f7ff; border-left: 4px solid #667eea; padding: 15px; margin: 20px 0; border-radius: 4px; }
    .button { display: inline-block; background: #667eea; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; margin: 10px 0; }
    .footer { background-color: #f8f9fa; padding: 20px; font-size: 14px; color: #666; }
    .signature { border-top: 1px solid #eee; padding-top: 15px; margin-top: 20px; }
    @media (max-width: 600px) { body { padding: 10px; } .content, .header { padding: 20px; } }
  </style>
`;
// Generar archivo .ics para citas
const generateICS = (appointmentDate, tutorName, tutorEmail, notes) => {
    try {
        console.log('üìÖ Generando archivo ICS para cita');
        // Configurar evento de 60 minutos en zona horaria America/Santiago
        const endDate = new Date(appointmentDate.getTime() + 60 * 60 * 1000);
        const event = {
            start: [
                appointmentDate.getFullYear(),
                appointmentDate.getMonth() + 1,
                appointmentDate.getDate(),
                appointmentDate.getHours(),
                appointmentDate.getMinutes()
            ],
            end: [
                endDate.getFullYear(),
                endDate.getMonth() + 1,
                endDate.getDate(),
                endDate.getHours(),
                endDate.getMinutes()
            ],
            title: 'Consulta Veterinaria - Ale Veterinaria',
            description: notes ? `Consulta veterinaria a domicilio.\n\nNotas: ${notes}` : 'Consulta veterinaria a domicilio',
            location: 'Domicilio del tutor',
            status: 'CONFIRMED',
            organizer: { name: SIGNATURE.name, email: 'contacto@aleveterinaria.cl' },
            attendees: [{ name: tutorName, email: tutorEmail, rsvp: true }],
            uid: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}@aleveterinaria.cl`
        };
        const { error, value } = (0, ics_1.createEvent)(event);
        if (error) {
            console.error('‚ùå Error generando ICS:', error);
            return undefined;
        }
        console.log('‚úÖ Archivo ICS generado exitosamente');
        return Buffer.from(value, 'utf-8');
    }
    catch (error) {
        console.error('‚ùå Error en generateICS:', error);
        return undefined;
    }
};
// Plantilla base HTML
const baseTemplate = (title, content) => `
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${title}</title>
  ${EMAIL_STYLES}
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üêæ Ale Veterinaria</h1>
      <p>Atenci√≥n veterinaria a domicilio con amor y profesionalismo</p>
    </div>
    <div class="content">
      ${content}
    </div>
    <div class="footer">
      <div class="signature">
        <strong>${SIGNATURE.name}</strong><br>
        ${SIGNATURE.title}<br>
        üì± ${SIGNATURE.phone}<br>
        üí¨ <a href="${SIGNATURE.whatsapp}">WhatsApp</a> |
        üì∏ <a href="https://instagram.com/${SIGNATURE.instagram.substring(1)}">${SIGNATURE.instagram}</a>
      </div>
      <p style="margin-top: 15px; font-size: 12px; color: #999;">
        Este email fue enviado autom√°ticamente por el sistema de Ale Veterinaria.<br>
        Si tienes alguna consulta, responde a este correo o cont√°ctanos por WhatsApp.
      </p>
    </div>
  </div>
</body>
</html>
`;
// 1. Plantilla de formulario de contacto
const getContactFormTemplate = (data) => {
    var _a;
    const subject = `Contacto web: ${data.senderName}`;
    const content = `
    <h2>üí¨ Nuevo mensaje desde el formulario de contacto</h2>
    <div class="highlight">
      <p><strong>Nombre:</strong> ${data.senderName}</p>
      <p><strong>Email:</strong> ${data.senderEmail}</p>
      <p><strong>Mensaje:</strong></p>
      <p>${(_a = data.contactMessage) === null || _a === void 0 ? void 0 : _a.replace(/\n/g, '<br>')}</p>
    </div>
    <p>Este mensaje fue enviado desde el formulario de contacto del sitio web.</p>
  `;
    return {
        subject,
        text: `Nuevo mensaje de contacto\n\nNombre: ${data.senderName}\nEmail: ${data.senderEmail}\n\nMensaje:\n${data.contactMessage}`,
        html: baseTemplate(subject, content)
    };
};
exports.getContactFormTemplate = getContactFormTemplate;
// 2. Plantilla de confirmaci√≥n de cita
const getAppointmentConfirmationTemplate = (data) => {
    var _a;
    const subject = '‚úÖ Confirmaci√≥n de cita - Ale Veterinaria';
    const appointmentDateStr = (_a = data.appointmentDate) === null || _a === void 0 ? void 0 : _a.toLocaleString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full',
        timeStyle: 'short'
    });
    const content = `
    <h2>‚úÖ Tu cita ha sido confirmada</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Hemos confirmado tu cita para <strong>${data.patientName}</strong> (${data.species}).</p>
    
    <div class="highlight">
      <h3>üìÖ Detalles de la cita:</h3>
      <p><strong>Fecha y hora:</strong> ${appointmentDateStr}</p>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p><strong>Tutor:</strong> ${data.tutorName}</p>
      ${data.appointmentNotes ? `<p><strong>Notas:</strong> ${data.appointmentNotes}</p>` : ''}
    </div>

    <p>üìç La consulta ser√° realizada en tu domicilio. Te confirmaremos la hora exacta el d√≠a anterior.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Contactar por WhatsApp</a>
    
    <p><strong>¬øNecesitas reagendar?</strong> Cont√°ctanos por WhatsApp o responde a este email.</p>
  `;
    const icsBuffer = data.appointmentDate ? generateICS(data.appointmentDate, data.tutorName, data.tutorEmail, data.appointmentNotes) : undefined;
    return {
        subject,
        text: `Confirmaci√≥n de cita\n\nHola ${data.tutorName},\n\nTu cita para ${data.patientName} ha sido confirmada para el ${appointmentDateStr}.\n\nNos vemos pronto!`,
        html: baseTemplate(subject, content),
        icsBuffer
    };
};
exports.getAppointmentConfirmationTemplate = getAppointmentConfirmationTemplate;
// 3. Recordatorio de cita (48h, 24h, mismo d√≠a)
const getAppointmentReminderTemplate = (data, reminderType) => {
    var _a;
    const titles = {
        '48h': 'üîî Recordatorio: Tu cita es en 2 d√≠as',
        '24h': '‚è∞ Recordatorio: Tu cita es ma√±ana',
        'today': 'üö® Recordatorio: Tu cita es hoy'
    };
    const subject = titles[reminderType];
    const appointmentDateStr = (_a = data.appointmentDate) === null || _a === void 0 ? void 0 : _a.toLocaleString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full',
        timeStyle: 'short'
    });
    const content = `
    <h2>${titles[reminderType]}</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Te recordamos que tienes una cita confirmada para <strong>${data.patientName}</strong>.</p>
    
    <div class="highlight">
      <h3>üìÖ Detalles de la cita:</h3>
      <p><strong>Fecha y hora:</strong> ${appointmentDateStr}</p>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
    </div>

    <p>üìç Nos vemos en tu domicilio a la hora acordada.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Contactar por WhatsApp</a>
    
    <p>Si necesitas cancelar o reagendar, cont√°ctanos lo antes posible.</p>
  `;
    return {
        subject,
        text: `${titles[reminderType]}\n\nHola ${data.tutorName},\n\nRecordatorio de cita para ${data.patientName} el ${appointmentDateStr}.\n\nNos vemos pronto!`,
        html: baseTemplate(subject, content)
    };
};
exports.getAppointmentReminderTemplate = getAppointmentReminderTemplate;
// 4. Recordatorio de vacuna pr√≥xima
const getVaccineReminderTemplate = (data) => {
    var _a;
    const subject = 'üíâ Recordatorio: Vacuna pr√≥xima para ' + data.patientName;
    const nextDoseStr = (_a = data.nextDose) === null || _a === void 0 ? void 0 : _a.toLocaleDateString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full'
    });
    const content = `
    <h2>üíâ Recordatorio de vacunaci√≥n</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Te recordamos que <strong>${data.patientName}</strong> tiene una dosis de vacuna pr√≥xima.</p>
    
    <div class="highlight">
      <h3>üíâ Detalles de la vacuna:</h3>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p><strong>Vacuna:</strong> ${data.vaccineType}</p>
      <p><strong>Fecha programada:</strong> ${nextDoseStr}</p>
    </div>

    <p>Es importante mantener al d√≠a las vacunas para proteger la salud de tu mascota.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Agendar por WhatsApp</a>
    
    <p>Cont√°ctanos para agendar la aplicaci√≥n de la vacuna a domicilio.</p>
  `;
    return {
        subject,
        text: `Recordatorio de vacuna\n\nHola ${data.tutorName},\n\n${data.patientName} tiene una dosis de ${data.vaccineType} programada para el ${nextDoseStr}.\n\nCont√°ctanos para agendar.`,
        html: baseTemplate(subject, content)
    };
};
exports.getVaccineReminderTemplate = getVaccineReminderTemplate;
// 5. Recordatorio de desparasitaci√≥n
const getDewormingReminderTemplate = (data) => {
    var _a;
    const subject = 'üõ°Ô∏è Recordatorio: Desparasitaci√≥n para ' + data.patientName;
    const nextDoseStr = (_a = data.nextDose) === null || _a === void 0 ? void 0 : _a.toLocaleDateString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full'
    });
    const content = `
    <h2>üõ°Ô∏è Recordatorio de desparasitaci√≥n</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Te recordamos que <strong>${data.patientName}</strong> necesita su pr√≥xima desparasitaci√≥n.</p>
    
    <div class="highlight">
      <h3>üõ°Ô∏è Detalles:</h3>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p><strong>Producto:</strong> ${data.productName}</p>
      <p><strong>Fecha programada:</strong> ${nextDoseStr}</p>
    </div>

    <p>La desparasitaci√≥n regular es fundamental para mantener la salud de tu mascota.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Consultar por WhatsApp</a>
    
    <p>Podemos orientarte sobre el mejor producto y aplicaci√≥n a domicilio.</p>
  `;
    return {
        subject,
        text: `Recordatorio de desparasitaci√≥n\n\nHola ${data.tutorName},\n\n${data.patientName} necesita desparasitaci√≥n programada para el ${nextDoseStr}.\n\nCont√°ctanos para m√°s informaci√≥n.`,
        html: baseTemplate(subject, content)
    };
};
exports.getDewormingReminderTemplate = getDewormingReminderTemplate;
// 6. Plantilla de cancelaci√≥n de cita
const getAppointmentCancellationTemplate = (data) => {
    var _a;
    const subject = '‚ùå Cita Cancelada - Ale Veterinaria';
    const appointmentDateStr = (_a = data.appointmentDate) === null || _a === void 0 ? void 0 : _a.toLocaleString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full',
        timeStyle: 'short'
    });
    const content = `
    <h2>‚ùå Tu cita ha sido cancelada</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Te confirmamos que la cita para <strong>${data.patientName}</strong> (${data.species}) ha sido cancelada.</p>
    
    <div class="highlight">
      <h3>üìÖ Detalles de la cita cancelada:</h3>
      <p><strong>Fecha y hora:</strong> ${appointmentDateStr}</p>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p><strong>Servicio:</strong> ${data.serviceType}</p>
    </div>

    <p>üìç Si deseas reagendar o necesitas una nueva cita, no dudes en contactarnos.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Contactar por WhatsApp</a>
    
    <p><strong>¬øNecesitas otra cita?</strong> Cont√°ctanos por WhatsApp o responde a este email.</p>
  `;
    return {
        subject,
        text: `Cita cancelada\n\nHola ${data.tutorName},\n\nTu cita para ${data.patientName} programada para el ${appointmentDateStr} ha sido cancelada.\n\nCont√°ctanos si necesitas reagendar.`,
        html: baseTemplate(subject, content)
    };
};
exports.getAppointmentCancellationTemplate = getAppointmentCancellationTemplate;
// 7. Plantilla de modificaci√≥n de cita
const getAppointmentUpdateTemplate = (data) => {
    var _a;
    const subject = '‚úèÔ∏è Cita Modificada - Ale Veterinaria';
    const appointmentDateStr = (_a = data.appointmentDate) === null || _a === void 0 ? void 0 : _a.toLocaleString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full',
        timeStyle: 'short'
    });
    const content = `
    <h2>‚úèÔ∏è Tu cita ha sido modificada</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Te confirmamos que la cita para <strong>${data.patientName}</strong> (${data.species}) ha sido actualizada con los nuevos datos.</p>
    
    <div class="highlight">
      <h3>üìÖ Nuevos detalles de la cita:</h3>
      <p><strong>Fecha y hora:</strong> ${appointmentDateStr}</p>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p><strong>Servicio:</strong> ${data.serviceType}</p>
      <p><strong>Direcci√≥n:</strong> ${data.address}</p>
      ${data.appointmentNotes ? `<p><strong>Notas:</strong> ${data.appointmentNotes}</p>` : ''}
    </div>

    <p>üìç La consulta ser√° realizada en tu domicilio a la nueva hora acordada.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Contactar por WhatsApp</a>
    
    <p><strong>¬øTienes dudas?</strong> Cont√°ctanos por WhatsApp o responde a este email.</p>
  `;
    const icsBuffer = data.appointmentDate ? generateICS(data.appointmentDate, data.tutorName, data.tutorEmail, data.appointmentNotes) : undefined;
    return {
        subject,
        text: `Cita modificada\n\nHola ${data.tutorName},\n\nTu cita para ${data.patientName} ha sido actualizada para el ${appointmentDateStr}.\n\nNos vemos pronto!`,
        html: baseTemplate(subject, content),
        icsBuffer
    };
};
exports.getAppointmentUpdateTemplate = getAppointmentUpdateTemplate;
// 8. Plantilla de env√≠o de documentos/ex√°menes
const getExamDocumentTemplate = (data) => {
    const subject = `üìã Resultados de Ex√°menes - ${data.patientName} - Ale Veterinaria`;
    const content = `
    <h2>üìã Resultados de ex√°menes disponibles</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Los resultados de los ex√°menes de <strong>${data.patientName}</strong> ya est√°n disponibles.</p>
    
    <div class="highlight">
      <h3>üìÑ Detalles del documento:</h3>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p><strong>Tipo de examen:</strong> ${data.productName || 'Examen m√©dico'}</p>
      <p><strong>Fecha:</strong> ${new Date().toLocaleDateString('es-CL', {
        timeZone: 'America/Santiago',
        dateStyle: 'full'
    })}</p>
      ${data.appointmentNotes ? `<p><strong>Observaciones:</strong> ${data.appointmentNotes}</p>` : ''}
    </div>

    <p>üìÅ El documento adjunto contiene todos los resultados detallados.</p>
    <p>üìû Si tienes alguna consulta sobre los resultados, no dudes en contactarnos.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Consultar por WhatsApp</a>
    
    <p><strong>¬øNecesitas una consulta de seguimiento?</strong> Cont√°ctanos para agendar una cita y revisar los resultados juntos.</p>
  `;
    return {
        subject,
        text: `Resultados de ex√°menes\n\nHola ${data.tutorName},\n\nLos resultados de los ex√°menes de ${data.patientName} est√°n disponibles en el documento adjunto.\n\nCont√°ctanos si tienes consultas.`,
        html: baseTemplate(subject, content)
    };
};
exports.getExamDocumentTemplate = getExamDocumentTemplate;
// 9. Seguimiento post-consulta (7 d√≠as despu√©s)
const getFollowUpTemplate = (data) => {
    const subject = 'üíù ¬øC√≥mo est√° ' + data.patientName + '? - Seguimiento';
    const content = `
    <h2>üíù Seguimiento post-consulta</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Ha pasado una semana desde la consulta de <strong>${data.patientName}</strong> y queremos saber c√≥mo est√°.</p>
    
    <div class="highlight">
      <h3>üë©‚Äç‚öïÔ∏è Nos interesa saber:</h3>
      <ul>
        <li>¬øC√≥mo ha evolucionado ${data.patientName}?</li>
        <li>¬øHay alguna mejor√≠a en su condici√≥n?</li>
        <li>¬øTienes alguna consulta sobre el tratamiento?</li>
        <li>¬øNecesitas agendar un control de seguimiento?</li>
      </ul>
    </div>

    <p>Tu mascota es importante para nosotros y queremos asegurar su completa recuperaci√≥n.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Responder por WhatsApp</a>
    
    <p>No dudes en contactarnos si tienes cualquier duda o inquietud.</p>
  `;
    return {
        subject,
        text: `Seguimiento post-consulta\n\nHola ${data.tutorName},\n\n¬øC√≥mo est√° ${data.patientName} despu√©s de la consulta? Queremos saber su evoluci√≥n.\n\nCont√°ctanos si tienes dudas.`,
        html: baseTemplate(subject, content)
    };
};
exports.getFollowUpTemplate = getFollowUpTemplate;
// 7. Recordatorio de ex√°menes pendientes
const getExamReminderTemplate = (data) => {
    const subject = 'üî¨ Recordatorio: Ex√°menes pendientes para ' + data.patientName;
    const content = `
    <h2>üî¨ Recordatorio de ex√°menes</h2>
    <p>Hola <strong>${data.tutorName}</strong>,</p>
    <p>Te recordamos que <strong>${data.patientName}</strong> tiene ex√°menes m√©dicos pendientes.</p>
    
    <div class="highlight">
      <h3>üî¨ Informaci√≥n:</h3>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species})</p>
      <p>Han pasado varios d√≠as desde que se solicitaron los ex√°menes y no hemos recibido los resultados.</p>
    </div>

    <p>Los resultados de los ex√°menes son importantes para el diagn√≥stico y tratamiento adecuado.</p>
    
    <a href="${SIGNATURE.whatsapp}" class="button">üí¨ Consultar por WhatsApp</a>
    
    <p>Por favor cont√°ctanos para coordinar la entrega de resultados o resolver cualquier duda.</p>
  `;
    return {
        subject,
        text: `Recordatorio de ex√°menes\n\nHola ${data.tutorName},\n\n${data.patientName} tiene ex√°menes pendientes. Cont√°ctanos para coordinar la entrega de resultados.`,
        html: baseTemplate(subject, content)
    };
};
exports.getExamReminderTemplate = getExamReminderTemplate;
// 8. Cuestionario pre-visita completado
const getQuestionnaireCompletedTemplate = (data) => {
    const subject = `üìã Cuestionario pre-visita completado: ${data.patientName}`;
    const appointmentDateStr = data.appointmentDate ? data.appointmentDate.toLocaleDateString('es-CL') : 'Fecha pendiente';
    const content = `
    <h2>üìã Nuevo cuestionario pre-visita</h2>
    <p>Se ha completado un cuestionario pre-visita para la pr√≥xima consulta.</p>
    
    <div class="highlight">
      <h3>üìù Informaci√≥n de la consulta:</h3>
      <p><strong>Paciente:</strong> ${data.patientName} (${data.species || 'Especie no especificada'})</p>
      <p><strong>Tutor:</strong> ${data.tutorName}</p>
      <p><strong>Email:</strong> ${data.tutorEmail}</p>
      <p><strong>Fecha de cita:</strong> ${appointmentDateStr}</p>
    </div>

    ${data.questionnaireSummary ? `
    <div class="highlight">
      <h3>üìã Resumen del cuestionario:</h3>
      <p>${data.questionnaireSummary}</p>
    </div>
    ` : ''}

    <p>El cuestionario pre-visita est√° disponible en el portal profesional para revisar antes de la consulta.</p>
    
    <p>Esto te permitir√°:</p>
    <ul>
      <li>‚úÖ Preparar mejor la consulta</li>
      <li>‚úÖ Conocer las preocupaciones espec√≠ficas del tutor</li>
      <li>‚úÖ Adaptar el enfoque seg√∫n las necesidades del paciente</li>
    </ul>
    
    <p><strong>Recuerda revisar el cuestionario antes de la cita para brindar la mejor atenci√≥n Fear Free¬Æ.</strong></p>
  `;
    return {
        subject,
        text: `Cuestionario pre-visita completado: ${data.patientName}\n\nSe ha completado un cuestionario pre-visita para la pr√≥xima consulta.\n\nPaciente: ${data.patientName} (${data.species || 'Especie no especificada'})\nTutor: ${data.tutorName}\nEmail: ${data.tutorEmail}\nFecha de cita: ${appointmentDateStr}\n\n${data.questionnaireSummary ? `Resumen: ${data.questionnaireSummary}\n\n` : ''}El cuestionario est√° disponible en el portal profesional.\n\nSaludos,\nSistema Ale Veterinaria`,
        html: baseTemplate(subject, content)
    };
};
exports.getQuestionnaireCompletedTemplate = getQuestionnaireCompletedTemplate;
// ============================================
// PLANTILLAS DE WHATSAPP
// ============================================
const getWhatsAppTemplate = (templateType, data) => {
    const formatDateTime = (date) => {
        if (!date)
            return '';
        return date.toLocaleString('es-CL', {
            timeZone: 'America/Santiago',
            dateStyle: 'short',
            timeStyle: 'short'
        });
    };
    switch (templateType) {
        case 'appointment_created':
            return `üêæ *Cita confirmada* - Ale Veterinaria\n\nHola ${data.tutorName},\n\n‚úÖ Tu cita para ${data.patientName} ha sido agendada exitosamente.\n\nüìÖ *Detalles:*\n‚Ä¢ Fecha: ${formatDateTime(data.appointmentDate)}\n‚Ä¢ Paciente: ${data.patientName} (${data.species})\n‚Ä¢ Servicio: ${data.serviceType || 'Consulta veterinaria'}\n\nNos vemos pronto! üè†\n\nüìû ¬øDudas? Responde a este mensaje`;
        case 'reminder_48h':
            return `‚è∞ *Recordatorio* - Ale Veterinaria\n\nHola ${data.tutorName},\n\nüîî Te recordamos que tienes una cita para ${data.patientName} en 2 d√≠as.\n\nüìÖ *Detalles:*\n‚Ä¢ Fecha: ${formatDateTime(data.appointmentDate)}\n‚Ä¢ Paciente: ${data.patientName} (${data.species})\n\nNos vemos pronto! üêï`;
        case 'reminder_24h':
            return `‚è∞ *Recordatorio* - Ale Veterinaria\n\nHola ${data.tutorName},\n\nüö® Te recordamos que tienes una cita para ${data.patientName} *ma√±ana*.\n\nüìÖ *Detalles:*\n‚Ä¢ Fecha: ${formatDateTime(data.appointmentDate)}\n‚Ä¢ Paciente: ${data.patientName} (${data.species})\n\n¬°Nos vemos ma√±ana! üè†`;
        case 'reminder_today':
            return `üö® *Recordatorio* - Ale Veterinaria\n\nHola ${data.tutorName},\n\n‚è∞ Te recordamos que tienes una cita para ${data.patientName} *HOY*.\n\nüìÖ *Detalles:*\n‚Ä¢ Hora: ${formatDateTime(data.appointmentDate)}\n‚Ä¢ Paciente: ${data.patientName} (${data.species})\n\n¬°Nos vemos hoy! üêæ`;
        case 'appointment_cancelled':
            return `‚ùå *Cita cancelada* - Ale Veterinaria\n\nHola ${data.tutorName},\n\nTu cita para ${data.patientName} programada para el ${formatDateTime(data.appointmentDate)} ha sido cancelada.\n\nüìû ¬øNecesitas reagendar? Responde a este mensaje.`;
        case 'vaccine_reminder':
            return `üíâ *Recordatorio de vacuna* - Ale Veterinaria\n\nHola ${data.tutorName},\n\nüîî ${data.patientName} necesita su ${data.vaccineType || 'vacuna'} pr√≥ximamente.\n\nüìÖ Fecha sugerida: ${formatDateTime(data.nextDose)}\n\nüìû ¬øAgendamos la cita? Responde a este mensaje`;
        case 'deworming_reminder':
            return `ü™± *Recordatorio de desparasitaci√≥n* - Ale Veterinaria\n\nHola ${data.tutorName},\n\nüîî ${data.patientName} necesita su desparasitaci√≥n con ${data.productName || 'antiparasitario'}.\n\nüìÖ Fecha sugerida: ${formatDateTime(data.nextDose)}\n\nüìû ¬øAgendamos la cita? Responde a este mensaje`;
        case 'exam_results':
            return `üìã *Resultados disponibles* - Ale Veterinaria\n\nHola ${data.tutorName},\n\nLos resultados de los ex√°menes de ${data.patientName} ya est√°n listos.\n\nüìÑ Revisa tu portal del tutor para descargar los documentos.\n\nüìû ¬øTienes consultas? Responde a este mensaje`;
        case 'followup':
            return `üîÑ *Seguimiento* - Ale Veterinaria\n\nHola ${data.tutorName},\n\n¬øC√≥mo est√° ${data.patientName} despu√©s de la √∫ltima consulta?\n\nüìû Si necesitas una consulta de seguimiento o tienes dudas, responde a este mensaje.\n\n¬°Nos preocupamos por el bienestar de tu mascota! üêæ`;
        default:
            return `üêæ Ale Veterinaria\n\nHola ${data.tutorName},\n\nTienes una notificaci√≥n importante sobre ${data.patientName}.\n\nüìû Para m√°s informaci√≥n, cont√°ctanos.`;
    }
};
exports.getWhatsAppTemplate = getWhatsAppTemplate;
//# sourceMappingURL=templates.js.map